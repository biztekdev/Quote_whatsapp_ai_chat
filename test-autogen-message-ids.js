// Test auto-generated message ID patterns
console.log('ğŸ§ª Testing auto-generated message ID exclusion patterns...\n');

// Test the logic from sendMessageOnce
function isAutoGenerated(messageId) {
    return messageId.includes('auto-generated-') || 
           messageId.includes('error-response-') || 
           messageId.includes('error-flow-') ||
           messageId.includes('quote-response-') ||
           messageId.includes('material-selection-') ||
           messageId.includes('material-found-') ||
           messageId.includes('material-bypass-') ||
           messageId.includes('dimension-selection-') ||
           messageId.includes('finish-selection-') ||
           messageId.includes('finish-found-') ||
           messageId.includes('finish-bypass-');
}

const testCases = [
    { id: 'finish-found-1758744531448', expected: true, description: 'Current failing case' },
    { id: 'finish-bypass-1234567890', expected: true, description: 'Finish bypass case' },
    { id: 'material-found-1234567890', expected: true, description: 'Material found case' },
    { id: 'material-bypass-1234567890', expected: true, description: 'Material bypass case' },
    { id: 'error-response-1234567890', expected: true, description: 'Error response case' },
    { id: 'quote-response-1234567890', expected: true, description: 'Quote response case' },
    { id: 'wamid.HBgMOTIzMjYwNTMzMzM3', expected: false, description: 'Real WhatsApp message ID' },
    { id: 'regular-message-123', expected: false, description: 'Regular message ID' }
];

console.log('Testing message ID patterns:');
testCases.forEach((testCase, index) => {
    const result = isAutoGenerated(testCase.id);
    const status = result === testCase.expected ? 'âœ… PASS' : 'âŒ FAIL';
    
    console.log(`${index + 1}. ${testCase.description}`);
    console.log(`   ID: ${testCase.id}`);
    console.log(`   Expected: ${testCase.expected ? 'Auto-generated (skip tracking)' : 'Real message (use tracking)'}`);
    console.log(`   Result: ${result ? 'Auto-generated (skip tracking)' : 'Real message (use tracking)'}`);
    console.log(`   ${status}\n`);
});

console.log('ğŸ¯ Summary:');
console.log('   - finish-found-* IDs should now be excluded from status tracking');
console.log('   - This should fix the "Message status not found" error');
console.log('   - Real WhatsApp message IDs will still use status tracking');